Screen1 As screen:

    Form1 As form:
        DataSource: ='Excluding weekends'
        DefaultMode: =FormMode.New
        Height: =525
        NumberOfColumns: =1
        Width: =1366
        Y: =60
        ZIndex: =1

        Title_DataCard1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Title"
            Default: =ThisItem.Title
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Excluding weekends'],DataSourceInfo.DisplayName,"Title")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Excluding weekends'], DataSourceInfo.MaxLength, "Title")
            Required: =true
            Update: =DataCardValue1.Text
            Width: =1378
            X: =0
            Y: =0
            ZIndex: =2

            DataCardKey1 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                ZIndex: =2

            ErrorMessage1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue1.Y + DataCardValue1.Height
                ZIndex: =3

            StarVisible1 As label:
                Align: =Align.Center
                Height: =DataCardKey1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey1.Y
                ZIndex: =4

        "'Start Date_DataCard1' As typedDataCard.dateEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="StartDate"
            Default: =ThisItem.'Start Date'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Excluding weekends'],DataSourceInfo.DisplayName,"StartDate")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue2.SelectedDate
            Width: =1378
            X: =0
            Y: =1
            ZIndex: =2

            DataCardKey2 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue2 As datepicker:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DefaultDate: =Parent.Default
                DisplayMode: =Parent.DisplayMode
                EndYear: =Year(Today())+100
                IsEditable: =true
                OnChange: |-
                    =If(
                        Weekday(DataCardValue2.SelectedDate) = 1,
                        Set(
                            varStartDate,
                            DateAdd(
                                DataCardValue2.SelectedDate,
                                1,
                                Days
                            )
                        ),
                        Weekday(DataCardValue2.SelectedDate) = 7,
                        Set(
                            varStartDate,
                            DateAdd(
                                DataCardValue2.SelectedDate,
                                2,
                                Days
                            )
                        ),
                        Set(
                            varStartDate,
                            DataCardValue2.SelectedDate
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                StartYear: =1899
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                ZIndex: =2

            ErrorMessage2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue2.Y + DataCardValue2.Height
                ZIndex: =3

            StarVisible2 As label:
                Align: =Align.Center
                Height: =DataCardKey2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey2.Y
                ZIndex: =4

        "'End Date_DataCard1' As typedDataCard.dateEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="EndDate"
            Default: =ThisItem.'End Date'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Excluding weekends'],DataSourceInfo.DisplayName,"EndDate")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue3.SelectedDate
            Width: =1378
            X: =0
            Y: =2
            ZIndex: =2

            DataCardKey3 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue3 As datepicker:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DefaultDate: =Parent.Default
                DisplayMode: =Parent.DisplayMode
                EndYear: =Year(Today())+100
                IsEditable: =true
                OnChange: |-
                    =If(
                        Weekday(DataCardValue3.SelectedDate) = 1,
                        Set(
                            varEndDate,
                            DateAdd(
                                DataCardValue3.SelectedDate,
                                -2,
                                Days
                            )
                        ),
                        Weekday(DataCardValue3.SelectedDate) = 7,
                        Set(
                            varEndDate,
                            DateAdd(
                                DataCardValue3.SelectedDate,
                                -1,
                                Days
                            )
                        ),
                        Set(
                            varEndDate,
                            DataCardValue3.SelectedDate
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                StartYear: =1899
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey3.Y + DataCardKey3.Height + 5
                ZIndex: =2

            ErrorMessage3 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue3.Y + DataCardValue3.Height
                ZIndex: =3

            StarVisible3 As label:
                Align: =Align.Center
                Height: =DataCardKey3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey3.Y
                ZIndex: =4

        "'Date Difference_DataCard1' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="DateDifference"
            Default: =ThisItem.'Date Difference'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Excluding weekends'],DataSourceInfo.DisplayName,"DateDifference")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Excluding weekends'], DataSourceInfo.MaxLength, "DateDifference")
            Required: =false
            Update: =DataCardValue4.Text
            Width: =1378
            X: =0
            Y: =3
            ZIndex: =2

            DataCardKey4 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue4 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =DateDiff(DataCardValue2.SelectedDate,DataCardValue3.SelectedDate)+1
                    //Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey4.Y + DataCardKey4.Height + 5
                ZIndex: =2

            ErrorMessage4 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue4.Y + DataCardValue4.Height
                ZIndex: =3

            StarVisible4 As label:
                Align: =Align.Center
                Height: =DataCardKey4.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4.Y
                ZIndex: =4

        "'Date Difference Excluding Weekends_DataCard1' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="DateDifferenceExcludingWeekends"
            Default: =ThisItem.'Date Difference Excluding Weekends'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Excluding weekends'],DataSourceInfo.DisplayName,"DateDifferenceExcludingWeekends")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Excluding weekends'], DataSourceInfo.MaxLength, "DateDifferenceExcludingWeekends")
            Required: =false
            Update: =DataCardValue5.Text
            Width: =1378
            X: =0
            Y: =4
            ZIndex: =2

            DataCardKey5 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue5 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =RoundDown(
                        DateDiff(
                            DataCardValue2.SelectedDate,
                            DataCardValue3.SelectedDate,
                            Days
                        ) / 7,
                        0
                    ) * 5 + Mod(
                        5 + Weekday(DataCardValue3.SelectedDate) - Weekday(DataCardValue2.SelectedDate),
                        5
                    )
                    //Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey5.Y + DataCardKey5.Height + 5
                ZIndex: =2

            ErrorMessage5 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue5.Y + DataCardValue5.Height
                ZIndex: =3

            StarVisible5 As label:
                Align: =Align.Center
                Height: =DataCardKey5.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey5.Y
                ZIndex: =4

    Button1 As button:
        OnSelect: =SubmitForm(Form1)
        Text: ="Submit"
        X: =30
        Y: =585
        ZIndex: =2

    Label1 As label:
        Height: =42
        Text: |-
            ="Weeks " & RoundDown(
                DateDiff(
                    DataCardValue2.SelectedDate,
                    DataCardValue3.SelectedDate,
                    Days
                ) / 7,
                0
            )
        Width: =397
        ZIndex: =3

    Label2 As label:
        Height: =42
        Text: ="Business Days"
        Width: =425
        X: =440
        ZIndex: =4

    HtmlText1 As htmlViewer:
        Height: =150
        HtmlText: ="<ol><li>Calculate the number of whole weeks between the two dates</li><li>Then the difference of the days not in the whole weeks. For that we need to use the Weekday function.</li><li>The Mod function returns the remainder after a number is divided by a divisor.</li><li>Notice that the partial week calculation given above will not work if the start or end dates fall on weekends; in this case we’d need to decide what to do (either use the previous Friday or the following Monday) in the calculations – and that will depend on the application.</li></ol>"
        Width: =1069
        X: =274
        Y: =585
        ZIndex: =5

    Label1_1 As label:
        Height: =42
        Text: |-
            =//Mod(5 + Weekday(DataCardValue3.SelectedDate) - Weekday(DataCardValue2.SelectedDate), 5)
            "WeekDay " & Weekday(DataCardValue3.SelectedDate)
        Width: =397
        X: =969
        ZIndex: =6

    Label3 As label:
        BorderThickness: =2
        Height: =45
        Text: ="Start Date = " & varStartDate
        Width: =255
        X: =240
        Y: =42
        ZIndex: =7

    Label3_1 As label:
        BorderThickness: =2
        Height: =45
        Text: ="End Date = " & varEndDate
        Width: =255
        X: =572
        Y: =42
        ZIndex: =8

    Label3_2 As label:
        BorderThickness: =2
        Height: =45
        Text: |-
            ="Date Difference using variables = " & RoundDown(
                DateDiff(
                    varStartDate,
                    varEndDate,
                    Days
                ) / 7,
                0
            ) * 5 + Mod(
                5 + Weekday(varEndDate) - Weekday(varStartDate),
                5
            )
        Width: =446
        X: =897
        Y: =42
        ZIndex: =9

    Label3_3 As label:
        BorderThickness: =2
        Height: =45
        Text: |-
            =RoundDown(
                DateDiff(
                    If(
                        Weekday(DataCardValue2.SelectedDate) = 1,
                        DateAdd(
                            DataCardValue2.SelectedDate,
                            1,
                            Days
                        ),
                        Weekday(DataCardValue2.SelectedDate) = 7,
                        DateAdd(
                            DataCardValue2.SelectedDate,
                            2,
                            Days
                        ),
                        DataCardValue2.SelectedDate
                    ),
                    If(
                        Weekday(DataCardValue3.SelectedDate) = 1,
                        DateAdd(
                            DataCardValue3.SelectedDate,
                            -2,
                            Days
                        ),
                        Weekday(DataCardValue3.SelectedDate) = 7,
                        DateAdd(
                            DataCardValue3.SelectedDate,
                            -1,
                            Days
                        ),
                        DataCardValue3.SelectedDate
                    ),
                    Days
                ) / 7,
                0
            ) * 5 + Mod(
                5 + If(
                    Weekday(DataCardValue3.SelectedDate) = 1 || Weekday(DataCardValue3.SelectedDate) = 7,
                    6,
                    Weekday(DataCardValue3.SelectedDate)
                ) - If(
                    Weekday(DataCardValue2.SelectedDate) = 1 || Weekday(DataCardValue2.SelectedDate) = 7,
                    2,
                    Weekday(DataCardValue2.SelectedDate)
                ),
                5
            )
        Width: =446
        X: =920
        Y: =540
        ZIndex: =10

    Label3_4 As label:
        BorderThickness: =2
        Height: =45
        Text: |-
            =If(
                IsBlank(DataCardValue2.SelectedDate),
                "",
                If(
                    IsBlank(DataCardValue3.SelectedDate),
                    RoundDown(
                        DateDiff(
                            If(
                                Weekday(DataCardValue2.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    1,
                                    Days
                                ),
                                Weekday(DataCardValue2.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    2,
                                    Days
                                ),
                                DataCardValue2.SelectedDate
                            ),
                            If(
                                Weekday(Now()) = 1,
                                DateAdd(
                                    Now(),
                                    -2,
                                    Days
                                ),
                                Weekday(Now()) = 7,
                                DateAdd(
                                    Now(),
                                    -1,
                                    Days
                                ),
                                Now()
                            ),
                            Days
                        ) / 7,
                        0
                    ) * 5 + Mod(
                        5 + If(
                            Weekday(Now()) = 1 || Weekday(Now()) = 7,
                            6,
                            Weekday(Now())
                        ) - If(
                            Weekday(DataCardValue2.SelectedDate) = 1 || Weekday(DataCardValue2.SelectedDate) = 7,
                            2,
                            Weekday(DataCardValue2.SelectedDate)
                        ),
                        5
                    ) + 1,
                    RoundDown(
                        DateDiff(
                            If(
                                Weekday(DataCardValue2.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    1,
                                    Days
                                ),
                                Weekday(DataCardValue2.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    2,
                                    Days
                                ),
                                DataCardValue2.SelectedDate
                            ),
                            If(
                                Weekday(DataCardValue3.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue3.SelectedDate,
                                    -2,
                                    Days
                                ),
                                Weekday(DataCardValue3.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue3.SelectedDate,
                                    -1,
                                    Days
                                ),
                                DataCardValue3.SelectedDate
                            ),
                            Days
                        ) / 7,
                        0
                    ) * 5 + Mod(
                        5 + If(
                            Weekday(DataCardValue3.SelectedDate) = 1 || Weekday(DataCardValue3.SelectedDate) = 7,
                            6,
                            Weekday(DataCardValue3.SelectedDate)
                        ) - If(
                            Weekday(DataCardValue2.SelectedDate) = 1 || Weekday(DataCardValue2.SelectedDate) = 7,
                            2,
                            Weekday(DataCardValue2.SelectedDate)
                        ),
                        5
                    ) + 1
                )
            )
        Width: =446
        X: =397
        Y: =540
        ZIndex: =11

    Button3 As button:
        OnSelect: =ResetForm(Form1)
        Text: ="Button"
        X: =30
        Y: =640
        ZIndex: =12

    Label3_5 As label:
        BorderThickness: =2
        Height: =45
        Text: |-
            =If(
                IsBlank(DataCardValue2.SelectedDate),
                "",
                If(
                    IsBlank(DataCardValue3.SelectedDate),
                    RoundDown(
                        DateDiff(
                            If(
                                Weekday(DataCardValue2.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    -2,
                                    Days
                                ),
                                Weekday(DataCardValue2.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    -1,
                                    Days
                                ),
                                DataCardValue2.SelectedDate
                            ),
                            If(
                                Weekday(Now()) = 1,
                                DateAdd(
                                    Now(),
                                    1,
                                    Days
                                ),
                                Weekday(Now()) = 7,
                                DateAdd(
                                    Now(),
                                    2,
                                    Days
                                ),
                                Now()
                            ),
                            Days
                        ) / 7,
                        0
                    ) * 5 + Mod(
                        5 + If(
                            Weekday(Now()) = 1 || Weekday(Now()) = 7,
                            2,
                            Weekday(Now())
                        ) - If(
                            Weekday(DataCardValue2.SelectedDate) = 1 || Weekday(DataCardValue2.SelectedDate) = 7,
                            6,
                            Weekday(DataCardValue2.SelectedDate)
                        ),
                        5
                    ) + 1,
                    RoundDown(
                        DateDiff(
                            If(
                                Weekday(DataCardValue2.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    -2,
                                    Days
                                ),
                                Weekday(DataCardValue2.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue2.SelectedDate,
                                    -1,
                                    Days
                                ),
                                DataCardValue2.SelectedDate
                            ),
                            If(
                                Weekday(DataCardValue3.SelectedDate) = 1,
                                DateAdd(
                                    DataCardValue3.SelectedDate,
                                    1,
                                    Days
                                ),
                                Weekday(DataCardValue3.SelectedDate) = 7,
                                DateAdd(
                                    DataCardValue3.SelectedDate,
                                    2,
                                    Days
                                ),
                                DataCardValue3.SelectedDate
                            ),
                            Days
                        ) / 7,
                        0
                    ) * 5 + Mod(
                        5 + If(
                            Weekday(DataCardValue3.SelectedDate) = 1 || Weekday(DataCardValue3.SelectedDate) = 7,
                            2,
                            Weekday(DataCardValue3.SelectedDate)
                        ) - If(
                            Weekday(DataCardValue2.SelectedDate) = 1 || Weekday(DataCardValue2.SelectedDate) = 7,
                            6,
                            Weekday(DataCardValue2.SelectedDate)
                        ),
                        5
                    ) + 1
                )
            )
        Width: =446
        X: =397
        Y: =717
        ZIndex: =13

    Label3_6 As label:
        BorderThickness: =2
        Height: =45
        Text: |-
            =If(
                DataCardValue2.SelectedDate = DataCardValue3.SelectedDate || DataCardValue2.SelectedDate = DateAdd(
                    DataCardValue3.SelectedDate,
                    -1,
                    Days
                ),
                0
            )
        Width: =446
        X: =920
        Y: =717
        ZIndex: =14

